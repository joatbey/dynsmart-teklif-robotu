<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>DynSmart Bayi & Teklif Robotu</title>

<style>
body{font-family:Segoe UI,Tahoma,sans-serif;background:#f8fafc;margin:0}
.ds-master{max-width:1200px;margin:20px auto;background:#fff}
.ds-container{border:2px solid #217346;border-radius:8px;overflow:hidden}
.ds-header-area{background:#217346;color:#fff;padding:15px 20px;display:flex;justify-content:space-between;align-items:center}
.reset-btn{background:#ef4444;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:11px;font-weight:bold}
.client-info-bar{background:#f0fdf4;padding:15px 20px;border-bottom:1px solid #dcfce7;display:flex;gap:10px;align-items:center}
.client-input{flex:1;padding:8px;border:1px solid #217346;border-radius:4px;font-weight:bold}
.excel-grid{width:100%;border-collapse:collapse}
.excel-grid th,.excel-grid td{border:1px solid #ddd;padding:6px 8px;font-size:13px}
.excel-grid th{background:#e6e6e6;text-transform:uppercase;font-size:12px}
.h-center{text-align:center;font-weight:bold}
.inp-common{width:100%;border:none;background:transparent}
.inp-common:focus{outline:none;border:1px solid #217346;background:#fff}
.inp-qty,.inp-price-qty{width:70px;text-align:center;font-weight:bold}
.inp-price-qty{background:#f0fdf4;border:2px solid #217346}
.calc-val{text-align:right;font-family:Consolas,monospace;font-weight:600}
.gap-row td{border:none;height:10px;background:#f4f4f4}
.panel-area{display:grid;grid-template-columns:1.3fr 1fr;gap:20px;padding:20px;background:#f8fafc;border-top:3px solid #217346}
.ctrl-item{background:#fff;border:1px solid #cbd5e1;border-radius:6px;padding:10px}
.ctrl-item label{font-size:10px;font-weight:800;color:#64748b}
.ctrl-item input{width:100%;border:none;font-size:18px;font-weight:800;text-align:center}
.summary-card{background:#1e293b;color:#fff;padding:25px;border-radius:12px;text-align:right}
.big-num{font-size:28px;font-weight:800;color:#4ade80}
.mid-num{font-size:22px;font-weight:700;color:#60a5fa}
.word-btn{background:#2b579a;color:#fff;border:none;padding:14px 30px;font-size:18px;font-weight:bold;border-radius:8px;cursor:pointer}
</style>
</head>

<body>
<div class="ds-master">
<div class="ds-container">

<div class="ds-header-area">
  <strong>DynSmart Bayi & Teklif Robotu</strong>
  <button class="reset-btn" onclick="resetToDefaults()">â†º SÄ±fÄ±rla</button>
</div>

<div class="client-info-bar">
  <strong>MÃœÅžTERÄ°:</strong>
  <input id="clientName" class="client-input" placeholder="Firma adÄ±" oninput="saveState()"/>
</div>

<table class="excel-grid">
<thead>
<tr>
<th>Tip</th><th>ÃœrÃ¼n</th><th>Adet</th><th>Fiyat Adet</th><th>Birim $</th><th>Tutar $</th><th>Yenileme $</th>
</tr>
</thead>
<tbody id="gridBody"></tbody>
</table>

<div class="panel-area">
<div>
  <div class="ctrl-item"><label>DÃ–VÄ°Z KUR</label><input id="kur" type="number" value="43" oninput="calcAll()"/></div>
  <div class="ctrl-item"><label>MÃœÅžTERÄ° Ä°SKONTO %</label><input id="isk" type="number" value="50" oninput="calcAll()"/></div>
</div>
<div class="summary-card">
  <div>MÃœÅžTERÄ° TOPLAM<div id="toplam" class="big-num">0 TL</div></div>
  <div>BAYÄ° PAYI<div id="bayi" class="mid-num">0 TL</div></div>
</div>
</div>

</div>

<div style="text-align:center;margin:20px">
<button class="word-btn" onclick="downloadWord()">ðŸ“„ Word Olarak Ä°ndir</button>
</div>

</div>

<script>
const defaultData=[
 {t:"-",n:"DynSmart Core ANA PAKET",p:1499,r:0.7,q:0},
 {t:"EK",n:"Åžube",p:249,r:0.1,q:0},
 {gap:true},
 {t:"EK",n:"Kasa",p:29,r:0.1,q:0}
];

let data=JSON.parse(localStorage.getItem("ds_data"))||structuredClone(defaultData);

function render(){
 const body=document.getElementById("gridBody");
 body.innerHTML="";
 data.forEach((d,i)=>{
  if(d.gap){
   body.innerHTML+=`<tr class="gap-row"><td colspan="7"></td></tr>`;
   return;
  }
  body.innerHTML+=`
  <tr data-idx="${i}">
   <td class="h-center">${d.t}</td>
   <td>${d.n}</td>
   <td><input type="number" class="inp-qty" value="${d.q}" min="0"
        oninput="data[${i}].q=this.value;calcAll()"></td>
   <td class="h-center" id="bq-${i}">0</td>
   <td>${d.p}</td>
   <td class="calc-val" id="t-${i}">0</td>
   <td class="calc-val" id="r-${i}">0</td>
  </tr>`;
 });
}

function calcAll(){
 const kur=+document.getElementById("kur").value||0;
 const isk=(100-(+document.getElementById("isk").value||0))/100;
 let total=0,renew=0;

 data.forEach((d,i)=>{
  if(d.gap)return;
  const bq=Math.max(0,d.q-(d.n==="Åžube"?1:0));
  document.getElementById(`bq-${i}`).innerText=bq;
  const t=bq*d.p*isk;
  const r=bq*d.p*d.r;
  document.getElementById(`t-${i}`).innerText=t.toFixed(2);
  document.getElementById(`r-${i}`).innerText=r.toFixed(2);
  total+=t; renew+=r;
 });

 document.getElementById("toplam").innerText=(total*kur).toLocaleString("tr-TR")+" TL";
 document.getElementById("bayi").innerText=(total*kur*0.5).toLocaleString("tr-TR")+" TL";
 saveState();
}

function saveState(){
 localStorage.setItem("ds_data",JSON.stringify(data));
 localStorage.setItem("ds_client",clientName.value);
}

function resetToDefaults(){
 if(confirm("SÄ±fÄ±rlansÄ±n mÄ±?")){
  localStorage.clear();location.reload();
 }
}

function downloadWord(){
 const name=(clientName.value||"Musteri").replace(/\s+/g,"_");
 const html=`<html><body><h1>DynSmart Teklif</h1><p>MÃ¼ÅŸteri: ${name}</p></body></html>`;
 const blob=new Blob(["\ufeff",html],{type:"application/msword"});
 const a=document.createElement("a");
 a.href=URL.createObjectURL(blob);
 a.download=`DynSmart_Teklif_${name}.doc`;
 a.click();
}

render(); calcAll();
</script>
</body>
</html>
